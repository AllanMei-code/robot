<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>èŠå¤©æœºå™¨äººç¤ºä¾‹</title>
</head>
<body>
  <h2>æ¬¢è¿ä½¿ç”¨èŠå¤©æœºå™¨äºº</h2>
  <p>è¯·åœ¨å³ä¸‹è§’å¯¹è¯æ¡†è¾“å…¥å†…å®¹è¯•è¯•çœ‹ã€‚</p>

  <!-- âœ… åµŒå…¥ tawk.to -->
  <script type="text/javascript">
    var Tawk_API = Tawk_API || {}, Tawk_LoadStart = new Date();

    // âœ… åœ¨å…¨å±€æµ‹è¯•è„šæœ¬æ˜¯å¦åŠ è½½
    console.log("ğŸ’¡ é¡µé¢è„šæœ¬å·²åŠ è½½");

    // âœ… è®¾ç½®è®¿å®¢æ¶ˆæ¯å›è°ƒå‡½æ•°
    Tawk_API.onMessageVisitor = function (msgObj) {
      const messageText = msgObj.text || "";
      console.log("ğŸ“© æ”¶åˆ°è®¿å®¢æ¶ˆæ¯:", messageText);

      alert("âœ… è®¿å®¢æ¶ˆæ¯å·²è§¦å‘ï¼š" + messageText);  // âœ… æ–°å¢å¼¹çª—

      fetch("http://3.71.28.18:5000/chatbot", {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify({ question: messageText })  // âœ… æ­£ç¡®å˜é‡å
      })
      .then(res => res.json())
      .then(data => {
        console.log("ğŸ¤– æœºå™¨äººå›å¤:", data.answer);

        if (Tawk_API && typeof Tawk_API.say === "function") {
          Tawk_API.say(data.answer);
        }

        Tawk_API.addEvent('æœºå™¨äººè‡ªåŠ¨å›å¤', {
          description: data.answer
        });
      })
      .catch(error => console.error("âŒ æœºå™¨äººé”™è¯¯:", error));
    };

    // âœ… åŠ è½½ tawk.to è„šæœ¬
    (function () {
      var s1 = document.createElement("script"),
          s0 = document.getElementsByTagName("script")[0];
      s1.async = true;
      s1.src = 'https://embed.tawk.to/6870c062affcbd1910f86a9f/1ivs6v0e0';
      s1.charset = 'UTF-8';
      s1.setAttribute('crossorigin', '*');
      s0.parentNode.insertBefore(s1, s0);
    })();
  </script>
</body>
</html>
